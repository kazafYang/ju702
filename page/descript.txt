2017-11-25 
每天2点半判断日线cci指数的情况，结合具体情况进行分析：
$stat_date=date("Y-m-d",strtotime("-2 day"));
大趋势：
日线级别--》1
kd线金叉，价格站上五日均线做多 50%，快速建仓
(k or d <20) and now_price>5 avg
kd死叉，价格低于5日均线做空，快速出清--》不回转
(k or d >80) and now_price<5 avg
日线级别--》2
kd超卖，缓慢吸入筹码--》不回转
kd超买，缓慢卖出筹码--》不回转

20<kd<80
小趋势：
分时指标：（如果按照下方实现方式，就放弃了分时上的超卖低吸了，这样是否会造成仓位的流失？如果要造成流失，那么抛售仓位应该为多大？）
60分钟金叉死叉--》非常小--》开启回转-->回转数量不一样
30分钟金叉死叉--》非常小--》开启回转-->回转数量不一样
15分钟金叉死叉--》非常小--》开启回转-->回转数量不一样

目前存在的问题是15分钟判断存在问题，容易被套住，想去拿macd趋势

中午将这部分判定代码实现出来！然后下周投入使用，这次就这样了，后期开始用这样的方法来做；

2017-11-22
问题：
开关没限制到，可能存在问题；--->目前已经采取开关对整个逻辑进行限制，所以开关这个问题基本上说已经解决了；

已确定买入，15分钟和30分钟比较好，主力研判大趋势为周kdj

判定逻辑存在这样一个问题，根据kd值判定，当前期已经出现了新低那么后续在低位震荡过程中不会再次出现20给你抄底，而且高位也是50左右；
如果短期内出现小幅调整，也可能使kd值掉到20，或者30左右，但是也并不能说风险已经释放了，所以个人觉得还是要结合均线系统进行判断；
或者说当kdj已经在高位了，而股价高于5日均线，开始低于5日均线，这就是一个危险的信号；
同理当kdj出现在低位了，但是股价开始翻越5日均线说明后期将可能获利一波，然而当快速下跌抄底，价格在五日均线下方这个时候就变得非常危险，个人觉得必须要站上五日均线，那么这个时候可以杀入50%仓位，所以前期你的仓位比重必须维持到5层仓位以下，比如说这次就可以完美错过，或者说降低了不少损失；目前仓位全部进去了，得想想办法，把仓位给调整出来，乘着周末分析各大指数的走势情况

成交状态也是一个问题，目前抛单还在委托中，买单却已经挂了上来，这样就容易造成单总量的上升，但是如果今天军工的买单挂上去不撤销，即使成功了，后面埋单也成交了，可是筹码却收不回来了；

DeskPins



trade_bate 字典：
id=1,2,3 分别为日线kdj超买后，15分钟、30分钟、60分钟的买入指标
id=4 为回转交易卖出，分别为15分钟死叉，30、60分钟超卖，日线在20到80之间
id=8 为回转交易买入，买入指标为回转交易卖出的数量，然后回购回来
id=5,6,7 分别为日线kdj超卖后，15分钟、30分钟、60分钟的买入指标
id=9 为15分钟均线金叉级别，日线kdj低于55，买入交易
id=10 为15分钟均线死叉级别，日线高于65，卖出指标


首要任务就是先做好设计，只有设计做好了，才能更好的做后期的开发；目前的策略来说非常loser；其实并不需要做得非常复杂，就是一个低买高买赚取差价的这么一个原理而已，怎么将这个原理做下去才是道理；目前存在的问题就是逻辑太过混乱，没有将逻辑理清楚，这样策略就不清晰，就容易出现问题，比如说前期单纯的依靠15分钟30分钟，导致在一个上午的时间就将所有的筹码全部都买入了进去，如果这样做，后期将会非常危险；既然现在判定程序出现这么大的问题，是不是应该先紧急停掉程序，避免出现更大的失误？
首先怎么判断是低位？这个就需要策略来判定了，其次怎么介入，这个也需要策略，再次介入后如何成功抽身？成本到底应该是相对的成本，还是持仓的绝对成本？最后需要做的就是怎么判断买入卖出的成功性！昨天想到了一个方案就是直接使用复制的方式，拿到数据，没想到这个方法可行，嘻嘻，看来后期数据方面的保证要容易多了！！！
一、理清楚先后关系，判断的优先级；
开关策略：
当某一只可能存在超买现象，或者近期大趋势走势已经非常难看的情况下，那么这个时候将开关关闭，暂时放弃这一只的操作，当达到安全边际以后再开始买入进去潜伏这样不是很好的吗？而且目前存在的问题还有，分仓买入的标的太多了，也不利于观察和决策，导致数量过多引起混乱，以及T得不及时的现象；
kdj策略：
日线（一个阶段的判断）→可以由日线级别kdj线继续发散一下→得到当前日线是属于金叉还是死叉（这里需要判断日线kdj是否已经超买，作为买入条件判定），如果是死叉就没必要进入15分钟，30分钟，60分钟级别买入线了；→但是如果日线级别是金叉那么就可以买入分钟线进行判定；因为在大趋势向好的趋势下；
60分钟线（必须判断日线）
30分钟线（必须判断日线）
15分钟线（必须判断日线）
死叉、金叉策略：

均线策略：

做T回转交易策略：
做T需要参照前期观看过的文章，从文章中获得回转交易的策略模型,

其实这样来看就相当于所有的都需要日线级别的支持咯？
1、首先必须确定日线是在安全的情况下开展投资；但是这样就存在一个问题，当日线级别超买后往往还会发生一段行情，这个时候就吃不到这一部分，所以用日线约束的话就存在这个问题；
2、60分钟线，将是确定一个近2天行情的约束条件
3、15和30分钟是最近一天的的买入行情走势；所以如果要买入就可以用到这2个分钟线；
4、
二、才是完善交易系统和判定条件；
三、才是优化流程任务；











近期需要修改的地方：
1、完善操作、决策系统
1.1 加入回转系统操作怎么样呢？
回转系统数量不能超过50手
回转系统每次买入数量为最低值

2、降低vbs脚本执行等待时间，以便快速做出相应；
3、优化代码，让程序更健壮
3、


一、流程
1、获取kdj值
2、做出决策
3、响应决策指令
4、回传决策指令

二，决策策略
1、当分时kdj出现机会时
2、当日线出现机会时
3、


三、仓位控制
1、在什么时候应该具备什么样的仓位；
2、尽量不要满仓操作
3、尽量让自己活得更久一些，尽量多的吸入低价筹码，分摊筹码成本；

四、抓住机会
1、抓住这次机会，将筹码成本降低下来，等待下一次的启动，然后解套；
2、严格遵守操作纪律



 Dim objHtmlDoc
    WScript.Sleep 5000
    Set objShell= CreateObject("wscript.shell")
    objShell.SendKeys "{down 4}"
    objShell.sendkeys "^C"

    Set objHtmlDoc = CreateObject("htmlfile")
    a=objHtmlDoc.parentWindow.clipboardData.GetData("text")
MyArray = Split(a, " ", -1, 1)
    MyString =Replace(a, ",", ","),
msgbox MyString
msgbox MyArray(0)
msgbox MyArray(1)
    Set objHtmlDoc = Nothing

